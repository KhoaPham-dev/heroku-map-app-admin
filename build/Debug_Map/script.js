let demoContainer = document.querySelector('.demo-container');
let imageData;
let countClick = 0;
document.getElementById("image").onchange = function(e){
let fileReader = new FileReader();
let coord_1 = {
  x: 0,
  y: 0
}
let coord_2 = {
  x: 0,
  y: 0
}
fileReader.onloadend = function(){
  let imgTag = document.createElement('img');
  let resultReadFile = fileReader.result;
  imgTag.src = resultReadFile;
  imgTag.id = "img";
  document.getElementById("container").appendChild(imgTag);
  imgTag.onload = function(){
    document.getElementById("img").addEventListener('click', function(event){
      findPath(imgTag);
    })
  }
}
fileReader.readAsDataURL(e.target.files[0]);
}

function findPath(imgTag){
  let c = document.createElement("canvas");
  c.width = imgTag.width;
  c.height = imgTag.height;
  let ctx = c.getContext("2d");
  ctx.drawImage(imgTag,  0, 0, imgTag.width, imgTag.height);
  imageData = ctx.getImageData(0, 0, imgTag.width, imgTag.height);


let dataPath = {
    marked: {
      8522008: 8530008,8530008: 8530012,8530012: 8538012,8538012: 8546012,8546008: 8554008,8546012: 8546008,8554008: 8562008,8562008: 8570008,8570008: 8578008,8578008: 8586008,8586008: 8594008,8594008: 8602008,8602008: 8610008,8610008: 8618008,8618008: 8626008,8626008: 8634008,8634008: 8642008,8642008: 8650008,8650008: 8658008,8658004: 8666004,8658008: 8658004,8666004: 8674004,8674004: 8682004,8682004: 8690004,8690004: 8698004,8698004: 8706004,8706004: 8714004,8714004: 8722004,8722004: 8730004,8730004: 8738004,8738004: 8746004,8746004: 8754004,8754004: 8762004,8762004: 8770004,8770004: 8778004,8778004: 8786004,8786004: 8794004,8794004: 8802004,8802004: 8810004,8810004: 8818004,8818004: 8826004,8826004: 8834004,8834004: 8842004,8842004: 8850004,8850004: 8858004,8858004: 8866004,8866004: 8874004,8874004: 8882004,8882004: 8890004,8890004: 8898004,8898004: 8906004,8906004: 8914004,8914004: 8922004,8922004: 8930004,8930004: 8938004,8938004: 8946004,8946004: 8954004,8954004: 8962004,8962004: 8970004,8970004: 8978004,8978004: 8986004,8986000: 8994000,8986004: 8986000,8994000: 9002000,9002000: 9010000,9010000: 9018000,9018000: 9026000,9026000: 9034000,9034000: 9042000,9042000: 9050000,9050000: 9058000,9058000: 9066000,9066000: 9074000,9074000: 9082000,9082000: 9090000,9090000: 9098000,9098000: 9106000,9106000: 9114000,9114000: 9122000,9122000: 9130000,9130000: 9138000,9138000: 9146000,9146000: 9154000,9154000: 9162000,9162000: 9170000,9170000: 9178000,9178000: 9186000,9186000: 9194000,9194000: 9202000,9202000: 9210000,9210000: 9218000,9218000: 9226000,9226000: 9234000,9234000: 9242000,9242000: 9250000,9250000: 9258000,9258000: 9266000,9266000: 9274000,9274000: 9282000,9282000: 9282004,9282004: 9282008,9282008: 9282012,9282012: 9282016,9282016: 9282020,9282020: 9282024,9282024: 9282028,9282028: 9282032,9282032: 9282036,9282036: 9282040,9282040: 9282044,9282044: 9282048,9282048: 9282052,9282052: 9282056,9282056: 9282060,9282060: 9282064,9282064: 9282068,9282068: 9282072,9282072: 9282076,9282076: 9282080,9282080: 9282084,9282084: 9282088,9282088: 9282092,9282092: 9282096,9282096: 9282100,9282100: 9282104,9282104: 9282108,9282108: 9282112,9282112: 9282116,9282116: 9282120,9282120: 9282124,9282124: 9282128,9282128: 9282132,9282132: 9282136,9282136: 9282140,9282140: 9282144,9282144: 9282148,9282148: 9282152,9282152: 9282156,9282156: 9282160,9282160: 9282164,9282164: 9282168,9282168: 9282172,9282172: 9282176,9282176: 9282180,9282180: 9282184,9282184: 9282188,9282188: 9282192,9282192: 9282196,9282196: 9282200,9282200: 9282204,9282204: 9282208,9282208: 9282212,9282212: 9282216,9282216: 9282220,9282220: 9282224,9282224: 9282228,9282228: 9282232,9282232: 9282236,9282236: 9282240,9282240: 9282244,9282244: 9282248,9282248: 9282252,9282252: 9282256,9282256: 9282260,9282260: 9282264,9282264: 9282268,9282268: 9282272,9282272: 9282276,9282276: 9282280,9282280: 9282284,9282284: 9282288,9282288: 9282292,9282292: 9282296,9282296: 9282300,9282300: 9282304,9282304: 9282308,9282308: 9282312,9282312: 9282316,9282316: 9282320,9282320: 9282324,9282324: 9282328,9282328: 9282332,9282332: 9282336,9282336: 9282340,9282340: 9282344,9282344: 9282348,9282348: 9282352,9282352: 9282356,9282356: 9282360,9282360: 9282364,9282364: 9282368,9282368: 9282372,9282372: 9282376,9282376: 9282380,9282380: 9282384,9282384: 9282388,9282388: 9282392,9282392: 9282396,9282396: 9282400,9282400: 9282404,9282404: 9282408,9282408: 9282412,9282412: 9282416,9282416: 9282420,9282420: 9282424,9282424: 9282428,9282428: 9282432,9282432: 9282436,9282436: 9282440,9282440: 9282444,9282444: 9282448,9282448: 9282452,9282452: 9274452
    }
  };    

  //Tô màu đen lên các đường nối 2 điểm
  fillColorPathsOfTwoVertexs(c, imgTag, dataPath, 0,0,0);
}
function fillColorPathsOfTwoVertexs(c, imgTag, data, r, g ,b){
  c.width = imgTag.width;
  c.height = imgTag.height;
  let ctx = c.getContext("2d");
  ctx.drawImage(imgTag,  0, 0, imgTag.width, imgTag.height);
  imageData = ctx.getImageData(0, 0, imgTag.width, imgTag.height);
  //console.log(data);
  let count = 1;
    let prop = data.marked["791248"]
    // while(data.marked[prop]){
    //   imageData.data[prop] = r;
    //   imageData.data[prop + 1] = g;
    //   imageData.data[prop + 2] = b;
    //   prop = data.marked[prop];
    //   count++;
    //   if(!data.marked[prop])console.log(prop);
    // }
    for(let i in data.marked){
          imageData.data[data.marked[i]] = r;
          imageData.data[data.marked[i] + 1] = g;
          imageData.data[data.marked[i] + 2] = b;
          count++;
    }
  console.log(count);
  ctx.putImageData(imageData, 0, 0);
  demoContainer.removeChild(imgTag);
  demoContainer.appendChild(c);
  c.addEventListener("click", function(event){
      demoContainer.removeChild(c);
      demoContainer.appendChild(imgTag);
  })
}